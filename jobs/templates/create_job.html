{% extends "base.html" %}

{% block content %}

<div class="hero text-center">
    <h1>Create a New Job Posting</h1>
    <p class="lead">Fill in the job details below to add a new posting.</p>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card shadow-lg border-0">
            <div class="card-body p-4">

                <form id="jobForm">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Job Title</label>
                        <input id="title" class="form-control form-control-lg" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Description</label>
                        <textarea id="description" class="form-control form-control-lg" rows="4" required></textarea>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Experience Required</label>
                        <input id="experience" class="form-control form-control-lg" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Location</label>
                        <input id="location" class="form-control form-control-lg" required>
                    </div>

                    <button type="submit" class="btn btn-success btn-lg w-100">Submit Job</button>
                </form>

            </div>
        </div>
    </div>
</div>

<script>
document.getElementById("jobForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    let data = {
        title: document.getElementById("title").value,
        description: document.getElementById("description").value,
        experience: document.getElementById("experience").value,
        location: document.getElementById("location").value
    };

    const response = await fetch("/api/jobs/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify(data)
    });

    if (response.status === 201) {
        alert("Job created successfully!");
        window.location.href = "/jobs/list/";
    } else {
        alert("Error creating job.");
    }
});
</script>

{% endblock %}
